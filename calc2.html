<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PERS Retirement Calculator 2.4</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f9;
            color: #333;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .section {
            margin-bottom: 25px;
            padding: 15px;
            background: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }
        h3 {
            margin: 0 0 15px;
            color: #34495e;
        }
        label {
            display: inline-block;
            width: 180px;
            font-weight: bold;
            color: #555;
        }
        input[type="date"], input[type="number"], select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            width: 200px;
        }
        input[type="number"] {
            width: 180px;
        }
        .result {
            margin-top: 15px;
            padding: 10px;
            background: #e8f4f8;
            border: 1px solid #b3d4e0;
            border-radius: 4px;
            font-size: 14px;
            line-height: 1.5;
        }
        button {
            display: block;
            width: 200px;
            margin: 20px auto 0;
            padding: 10px;
            background: #3498db;
            color: #fff;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background: #2980b9;
        }
        /* Improved summary table styles */
        .summary-table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        .summary-table th, .summary-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        .summary-table th {
            background-color: #f2f2f2;
        }
        .summary-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>PERS Retirement Calculator</h1>

        <div class="section">
            <label for="tier">Select Tier:</label>
            <select id="tier">
                <option value="1">Tier 1</option>
                <option value="2">Tier 2</option>
                <option value="3">Tier 3</option>
                <option value="4">Tier 4</option>
                <option value="5">Tier 5</option>
            </select>
        </div>

        <!-- Default Work Start Date: 1990-02-05 -->
        <!-- To remove default, delete the value attribute -->
        <div class="section">
            <label for="startDate">Work Start Date:</label>
            <input type="date" id="startDate" value="1990-02-05" required>
        </div>

        <!-- Default Your Birthdate: 1966-10-28 -->
        <!-- To remove default, delete the value attribute -->
        <div class="section">
            <label for="birthDate">Your Birthdate:</label>
            <input type="date" id="birthDate" value="1966-10-28" required>
        </div>

        <!-- Default Spouse's Birthdate: 1977-07-05 -->
        <!-- To remove default, delete the value attribute -->
        <div class="section">
            <label for="spouseBirthDate">Spouse's Birthdate:</label>
            <input type="date" id="spouseBirthDate" value="1977-07-05">
        </div>

        <div class="section" id="retirement1">
            <h3>Retirement Option 1 (Required)</h3>
            <label for="retireDate1">Retirement Date:</label>
            <input type="date" id="retireDate1" required>
            <br>
            <label for="salary1">Average Salary (36 months):</label>
            <input type="number" id="salary1" required min="0" step="0.01">
            <div class="result" id="result1"></div>
        </div>

        <div class="section" id="retirement2">
            <h3>Retirement Option 2 (Optional)</h3>
            <label for="retireDate2">Retirement Date:</label>
            <input type="date" id="retireDate2">
            <br>
            <label for="salary2">Average Salary (36 months):</label>
            <input type="number" id="salary2" min="0" step="0.01">
            <div class="result" id="result2"></div>
        </div>

        <div class="section" id="retirement3">
            <h3>Retirement Option 3 (Optional)</h3>
            <label for="retireDate3">Retirement Date:</label>
            <input type="date" id="retireDate3">
            <br>
            <label for="salary3">Average Salary (36 months):</label>
            <input type="number" id="salary3" min="0" step="0.01">
            <div class="result" id="result3"></div>
        </div>

        <div class="section" id="retirement4">
            <h3>Retirement Option 4 (Optional)</h3>
            <label for="retireDate4">Retirement Date:</label>
            <input type="date" id="retireDate4">
            <br>
            <label for="salary4">Average Salary (36 months):</label>
            <input type="number" id="salary4" min="0" step="0.01">
            <div class="result" id="result4"></div>
        </div>

        <button onclick="calculate()">Calculate</button>
        <div class="summary" id="summary"></div>
    </div>

    <script>
const optionATable = {
            55: { 50: 0.8998, 51: 0.9025, 52: 0.9051, 53: 0.9078, 54: 0.9105, 55: 0.9133, 56: 0.9160, 57: 0.9187, 58: 0.9215, 59: 0.9242, 60: 0.9269, 61: 0.9296, 62: 0.9322, 63: 0.9348, 64: 0.9374, 65: 0.9400, 66: 0.9425, 67: 0.9450, 68: 0.9474, 69: 0.9498, 70: 0.9522 },
            56: { 50: 0.8934, 51: 0.8962, 52: 0.8990, 53: 0.9018, 54: 0.9047, 55: 0.9076, 56: 0.9105, 57: 0.9134, 58: 0.9164, 59: 0.9193, 60: 0.9222, 61: 0.9251, 62: 0.9279, 63: 0.9307, 64: 0.9335, 65: 0.9363, 66: 0.9390, 67: 0.9417, 68: 0.9443, 69: 0.9469, 70: 0.9494 },
            57: { 50: 0.8865, 51: 0.8894, 52: 0.8923, 53: 0.8953, 54: 0.8984, 55: 0.9014, 56: 0.9045, 57: 0.9076, 58: 0.9108, 59: 0.9139, 60: 0.9170, 61: 0.9201, 62: 0.9232, 63: 0.9262, 64: 0.9292, 65: 0.9322, 66: 0.9352, 67: 0.9381, 68: 0.9409, 69: 0.9437, 70: 0.9464 },
            58: { 50: 0.8791, 51: 0.8821, 52: 0.8852, 53: 0.8883, 54: 0.8915, 55: 0.8947, 56: 0.8980, 57: 0.9013, 58: 0.9046, 59: 0.9080, 60: 0.9113, 61: 0.9146, 62: 0.9180, 63: 0.9212, 64: 0.9245, 65: 0.9277, 66: 0.9309, 67: 0.9340, 68: 0.9371, 69: 0.9401, 70: 0.9431 },
            59: { 50: 0.8711, 51: 0.8742, 52: 0.8774, 53: 0.8807, 54: 0.8840, 55: 0.8875, 56: 0.8909, 57: 0.8944, 58: 0.8979, 59: 0.9015, 60: 0.9051, 61: 0.9086, 62: 0.9122, 63: 0.9157, 64: 0.9192, 65: 0.9227, 66: 0.9261, 67: 0.9295, 68: 0.9328, 69: 0.9361, 70: 0.9393 },
            60: { 50: 0.8625, 51: 0.8657, 52: 0.8690, 53: 0.8725, 54: 0.8760, 55: 0.8795, 56: 0.8832, 57: 0.8869, 58: 0.8906, 59: 0.8944, 60: 0.8982, 61: 0.9020, 62: 0.9058, 63: 0.9096, 64: 0.9134, 65: 0.9171, 66: 0.9208, 67: 0.9245, 68: 0.9281, 69: 0.9316, 70: 0.9351 },
            61: { 50: 0.8532, 51: 0.8565, 52: 0.8600, 53: 0.8635, 54: 0.8672, 55: 0.8709, 56: 0.8748, 57: 0.8786, 58: 0.8826, 59: 0.8866, 60: 0.8906, 61: 0.8947, 62: 0.8987, 63: 0.9028, 64: 0.9068, 65: 0.9109, 66: 0.9148, 67: 0.9188, 68: 0.9227, 69: 0.9265, 70: 0.9303 },
            62: { 50: 0.8432, 51: 0.8467, 52: 0.8502, 53: 0.8539, 54: 0.8577, 55: 0.8616, 56: 0.8656, 57: 0.8697, 58: 0.8738, 59: 0.8780, 60: 0.8823, 61: 0.8866, 62: 0.8909, 63: 0.8952, 64: 0.8996, 65: 0.9039, 66: 0.9082, 67: 0.9124, 68: 0.9166, 69: 0.9208, 70: 0.9249 },
            63: { 50: 0.8325, 51: 0.8361, 52: 0.8397, 53: 0.8435, 54: 0.8474, 55: 0.8515, 56: 0.8556, 57: 0.8599, 58: 0.8642, 59: 0.8687, 60: 0.8731, 61: 0.8777, 62: 0.8823, 63: 0.8869, 64: 0.8915, 65: 0.8962, 66: 0.9008, 67: 0.9053, 68: 0.9099, 69: 0.9143, 70: 0.9187 },
            64: { 50: 0.8211, 51: 0.8247, 52: 0.8285, 53: 0.8324, 54: 0.8364, 55: 0.8406, 56: 0.8449, 57: 0.8493, 58: 0.8538, 59: 0.8584, 60: 0.8632, 61: 0.8680, 62: 0.8728, 63: 0.8777, 64: 0.8826, 65: 0.8876, 66: 0.8925, 67: 0.8974, 68: 0.9023, 69: 0.9071, 70: 0.9119 },
            65: { 50: 0.8089, 51: 0.8125, 52: 0.8164, 53: 0.8203, 54: 0.8245, 55: 0.8288, 56: 0.8332, 57: 0.8378, 58: 0.8425, 59: 0.8473, 60: 0.8523, 61: 0.8573, 62: 0.8624, 63: 0.8676, 64: 0.8728, 65: 0.8781, 66: 0.8833, 67: 0.8886, 68: 0.8938, 69: 0.8990, 70: 0.9041 },
            66: { 50: 0.7958, 51: 0.7995, 52: 0.8034, 53: 0.8075, 54: 0.8117, 55: 0.8161, 56: 0.8207, 57: 0.8254, 58: 0.8303, 59: 0.8353, 60: 0.8404, 61: 0.8457, 62: 0.8511, 63: 0.8565, 64: 0.8620, 65: 0.8676, 66: 0.8732, 67: 0.8788, 68: 0.8844, 69: 0.8900, 70: 0.8955 },
            67: { 50: 0.7821, 51: 0.7859, 52: 0.7898, 53: 0.7939, 54: 0.7983, 55: 0.8028, 56: 0.8074, 57: 0.8123, 58: 0.8173, 59: 0.8225, 60: 0.8278, 61: 0.8333, 62: 0.8389, 63: 0.8446, 64: 0.8504, 65: 0.8563, 66: 0.8622, 67: 0.8682, 68: 0.8742, 69: 0.8801, 70: 0.8860 },
            68: { 50: 0.7677, 51: 0.7715, 52: 0.7755, 53: 0.7797, 54: 0.7841, 55: 0.7887, 56: 0.7934, 57: 0.7984, 58: 0.8036, 59: 0.8089, 60: 0.8144, 61: 0.8201, 62: 0.8259, 63: 0.8319, 64: 0.8380, 65: 0.8442, 66: 0.8504, 67: 0.8567, 68: 0.8631, 69: 0.8694, 70: 0.8758 },
            69: { 50: 0.7527, 51: 0.7566, 52: 0.7606, 53: 0.7648, 54: 0.7692, 55: 0.7739, 56: 0.7787, 57: 0.7838, 58: 0.7891, 59: 0.7946, 60: 0.8002, 61: 0.8061, 62: 0.8121, 63: 0.8183, 64: 0.8247, 65: 0.8312, 66: 0.8377, 67: 0.8444, 68: 0.8511, 69: 0.8578, 70: 0.8646 },
            70: { 50: 0.7371, 51: 0.7410, 52: 0.7450, 53: 0.7493, 54: 0.7537, 55: 0.7584, 56: 0.7633, 57: 0.7685, 58: 0.7739, 59: 0.7795, 60: 0.7853, 61: 0.7913, 62: 0.7975, 63: 0.8040, 64: 0.8105, 65: 0.8173, 66: 0.8242, 67: 0.8312, 68: 0.8382, 69: 0.8454, 70: 0.8526 }
        };

        const optionBTable = {
            55: { 50: 0.9240, 51: 0.9261, 52: 0.9282, 53: 0.9304, 54: 0.9325, 55: 0.9346, 56: 0.9368, 57: 0.9390, 58: 0.9411, 59: 0.9432, 60: 0.9454, 61: 0.9475, 62: 0.9495, 63: 0.9516, 64: 0.9536, 65: 0.9556, 66: 0.9576, 67: 0.9595, 68: 0.9615, 69: 0.9633, 70: 0.9652 },
            56: { 50: 0.9190, 51: 0.9212, 52: 0.9234, 53: 0.9257, 54: 0.9280, 55: 0.9302, 56: 0.9325, 57: 0.9349, 58: 0.9372, 59: 0.9395, 60: 0.9417, 61: 0.9440, 62: 0.9463, 63: 0.9485, 64: 0.9507, 65: 0.9528, 66: 0.9550, 67: 0.9571, 68: 0.9591, 69: 0.9612, 70: 0.9632 },
            57: { 50: 0.9136, 51: 0.9159, 52: 0.9182, 53: 0.9206, 54: 0.9230, 55: 0.9254, 56: 0.9279, 57: 0.9304, 58: 0.9328, 59: 0.9353, 60: 0.9377, 61: 0.9402, 62: 0.9426, 63: 0.9450, 64: 0.9474, 65: 0.9497, 66: 0.9520, 67: 0.9543, 68: 0.9565, 69: 0.9587, 70: 0.9609 },
            58: { 50: 0.9077, 51: 0.9101, 52: 0.9126, 53: 0.9151, 54: 0.9176, 55: 0.9202, 56: 0.9228, 57: 0.9254, 58: 0.9281, 59: 0.9307, 60: 0.9333, 61: 0.9360, 62: 0.9386, 63: 0.9412, 64: 0.9437, 65: 0.9463, 66: 0.9488, 67: 0.9512, 68: 0.9537, 69: 0.9560, 70: 0.9584 },
            59: { 50: 0.9013, 51: 0.9039, 52: 0.9064, 53: 0.9091, 54: 0.9117, 55: 0.9145, 56: 0.9172, 57: 0.9200, 58: 0.9228, 59: 0.9257, 60: 0.9285, 61: 0.9313, 62: 0.9341, 63: 0.9369, 64: 0.9397, 65: 0.9424, 66: 0.9451, 67: 0.9478, 68: 0.9504, 69: 0.9530, 70: 0.9555 },
            60: { 50: 0.8945, 51: 0.8971, 52: 0.8998, 53: 0.9025, 54: 0.9054, 55: 0.9082, 56: 0.9111, 57: 0.9141, 58: 0.9171, 59: 0.9201, 60: 0.9231, 61: 0.9261, 62: 0.9292, 63: 0.9322, 64: 0.9352, 65: 0.9381, 66: 0.9410, 67: 0.9439, 68: 0.9468, 69: 0.9496, 70: 0.9523 },
            61: { 50: 0.8870, 51: 0.8898, 52: 0.8926, 53: 0.8954, 54: 0.8984, 55: 0.9014, 56: 0.9045, 57: 0.9076, 58: 0.9108, 59: 0.9140, 60: 0.9172, 61: 0.9204, 62: 0.9236, 63: 0.9269, 64: 0.9301, 65: 0.9333, 66: 0.9365, 67: 0.9396, 68: 0.9427, 69: 0.9457, 70: 0.9487 },
            62: { 50: 0.8790, 51: 0.8818, 52: 0.8847, 53: 0.8877, 54: 0.8908, 55: 0.8939, 56: 0.8972, 57: 0.9005, 58: 0.9038, 59: 0.9072, 60: 0.9106, 61: 0.9141, 62: 0.9175, 63: 0.9210, 64: 0.9244, 65: 0.9279, 66: 0.9313, 67: 0.9347, 68: 0.9380, 69: 0.9413, 70: 0.9445 },
            63: { 50: 0.8704, 51: 0.8733, 52: 0.8763, 53: 0.8794, 54: 0.8826, 55: 0.8858, 56: 0.8892, 57: 0.8927, 58: 0.8962, 59: 0.8998, 60: 0.9034, 61: 0.9070, 62: 0.9107, 63: 0.9144, 64: 0.9181, 65: 0.9218, 66: 0.9255, 67: 0.9292, 68: 0.9328, 69: 0.9363, 70: 0.9398 },
            64: { 50: 0.8610, 51: 0.8640, 52: 0.8671, 53: 0.8703, 54: 0.8736, 55: 0.8770, 56: 0.8806, 57: 0.8842, 58: 0.8879, 59: 0.8916, 60: 0.8954, 61: 0.8993, 62: 0.9032, 63: 0.9072, 64: 0.9111, 65: 0.9151, 66: 0.9191, 67: 0.9230, 68: 0.9269, 69: 0.9307, 70: 0.9345 },
            65: { 50: 0.8510, 51: 0.8541, 52: 0.8573, 53: 0.8606, 54: 0.8640, 55: 0.8675, 56: 0.8712, 57: 0.8749, 58: 0.8788, 59: 0.8827, 60: 0.8868, 61: 0.8909, 62: 0.8950, 63: 0.8992, 64: 0.9034, 65: 0.9077, 66: 0.9119, 67: 0.9161, 68: 0.9203, 69: 0.9245, 70: 0.9286 },
            66: { 50: 0.8403, 51: 0.8434, 52: 0.8467, 53: 0.8501, 54: 0.8536, 55: 0.8573, 56: 0.8610, 57: 0.8649, 58: 0.8690, 59: 0.8731, 60: 0.8773, 61: 0.8816, 62: 0.8860, 63: 0.8904, 64: 0.8949, 65: 0.8994, 66: 0.9040, 67: 0.9085, 68: 0.9130, 69: 0.9175, 70: 0.9219 },
            67: { 50: 0.8290, 51: 0.8322, 52: 0.8355, 53: 0.8390, 54: 0.8426, 55: 0.8463, 56: 0.8502, 57: 0.8543, 58: 0.8585, 59: 0.8628, 60: 0.8672, 61: 0.8717, 62: 0.8763, 63: 0.8810, 64: 0.8857, 65: 0.8905, 66: 0.8954, 67: 0.9002, 68: 0.9050, 69: 0.9099, 70: 0.9147 },
            68: { 50: 0.8170, 51: 0.8203, 52: 0.8237, 53: 0.8272, 54: 0.8309, 55: 0.8348, 56: 0.8388, 57: 0.8430, 58: 0.8473, 59: 0.8517, 60: 0.8563, 61: 0.8610, 62: 0.8659, 63: 0.8708, 64: 0.8758, 65: 0.8809, 66: 0.8860, 67: 0.8912, 68: 0.8964, 69: 0.9015, 70: 0.9067 },
            69: { 50: 0.8045, 51: 0.8078, 52: 0.8112, 53: 0.8148, 54: 0.8186, 55: 0.8225, 56: 0.8267, 57: 0.8309, 58: 0.8354, 59: 0.8400, 60: 0.8448, 61: 0.8497, 62: 0.8547, 63: 0.8599, 64: 0.8651, 65: 0.8705, 66: 0.8759, 67: 0.8814, 68: 0.8869, 69: 0.8925, 70: 0.8980 },
            70: { 50: 0.7913, 51: 0.7946, 52: 0.7981, 53: 0.8018, 54: 0.8056, 55: 0.8097, 56: 0.8139, 57: 0.8182, 58: 0.8228, 59: 0.8276, 60: 0.8325, 61: 0.8376, 62: 0.8428, 63: 0.8482, 64: 0.8537, 65: 0.8594, 66: 0.8651, 67: 0.8709, 68: 0.8768, 69: 0.8827, 70: 0.8886 }
        };

        const optionCTable = {
            55: { 50: 0.9496, 51: 0.9510, 52: 0.9525, 53: 0.9540, 54: 0.9555, 55: 0.9570, 56: 0.9586, 57: 0.9601, 58: 0.9616, 59: 0.9631, 60: 0.9646, 61: 0.9661, 62: 0.9675, 63: 0.9690, 64: 0.9704, 65: 0.9718, 66: 0.9732, 67: 0.9746, 68: 0.9759, 69: 0.9772, 70: 0.9785 },
            56: { 50: 0.9461, 51: 0.9476, 52: 0.9492, 53: 0.9508, 54: 0.9524, 55: 0.9540, 56: 0.9557, 57: 0.9573, 58: 0.9589, 59: 0.9605, 60: 0.9621, 61: 0.9637, 62: 0.9653, 63: 0.9669, 64: 0.9684, 65: 0.9700, 66: 0.9715, 67: 0.9729, 68: 0.9744, 69: 0.9758, 70: 0.9773 },
            57: { 50: 0.9423, 51: 0.9440, 52: 0.9456, 53: 0.9473, 54: 0.9490, 55: 0.9508, 56: 0.9525, 57: 0.9542, 58: 0.9560, 59: 0.9577, 60: 0.9595, 61: 0.9612, 62: 0.9629, 63: 0.9646, 64: 0.9663, 65: 0.9679, 66: 0.9695, 67: 0.9711, 68: 0.9727, 69: 0.9743, 70: 0.9758 },
            58: { 50: 0.9382, 51: 0.9400, 52: 0.9417, 53: 0.9435, 54: 0.9453, 55: 0.9472, 56: 0.9490, 57: 0.9509, 58: 0.9527, 59: 0.9546, 60: 0.9565, 61: 0.9583, 62: 0.9602, 63: 0.9620, 64: 0.9638, 65: 0.9656, 66: 0.9674, 67: 0.9691, 68: 0.9708, 69: 0.9725, 70: 0.9742 },
            59: { 50: 0.9338, 51: 0.9356, 52: 0.9374, 53: 0.9393, 54: 0.9412, 55: 0.9432, 56: 0.9452, 57: 0.9471, 58: 0.9491, 59: 0.9512, 60: 0.9532, 61: 0.9552, 62: 0.9571, 63: 0.9591, 64: 0.9611, 65: 0.9630, 66: 0.9649, 67: 0.9668, 68: 0.9687, 69: 0.9705, 70: 0.9723 },
            60: { 50: 0.9290, 51: 0.9308, 52: 0.9328, 53: 0.9348, 54: 0.9368, 55: 0.9388, 56: 0.9409, 57: 0.9430, 58: 0.9452, 59: 0.9473, 60: 0.9495, 61: 0.9516, 62: 0.9538, 63: 0.9559, 64: 0.9580, 65: 0.9601, 66: 0.9622, 67: 0.9643, 68: 0.9663, 69: 0.9683, 70: 0.9702 },
            61: { 50: 0.9237, 51: 0.9257, 52: 0.9277, 53: 0.9298, 54: 0.9319, 55: 0.9341, 56: 0.9363, 57: 0.9385, 58: 0.9408, 59: 0.9431, 60: 0.9454, 61: 0.9477, 62: 0.9500, 63: 0.9523, 64: 0.9546, 65: 0.9568, 66: 0.9591, 67: 0.9613, 68: 0.9635, 69: 0.9657, 70: 0.9678 },
            62: { 50: 0.9180, 51: 0.9200, 52: 0.9221, 53: 0.9243, 54: 0.9265, 55: 0.9288, 56: 0.9311, 57: 0.9335, 58: 0.9359, 59: 0.9384, 60: 0.9408, 61: 0.9433, 62: 0.9458, 63: 0.9482, 64: 0.9507, 65: 0.9532, 66: 0.9556, 67: 0.9580, 68: 0.9604, 69: 0.9627, 70: 0.9650 },
            63: { 50: 0.9118, 51: 0.9139, 52: 0.9161, 53: 0.9184, 54: 0.9207, 55: 0.9231, 56: 0.9255, 57: 0.9280, 58: 0.9306, 59: 0.9332, 60: 0.9358, 61: 0.9384, 62: 0.9411, 63: 0.9437, 64: 0.9464, 65: 0.9490, 66: 0.9517, 67: 0.9543, 68: 0.9568, 69: 0.9594, 70: 0.9619 },
            64: { 50: 0.9051, 51: 0.9073, 52: 0.9096, 53: 0.9119, 54: 0.9143, 55: 0.9168, 56: 0.9194, 57: 0.9220, 58: 0.9247, 59: 0.9275, 60: 0.9302, 61: 0.9330, 62: 0.9359, 63: 0.9387, 64: 0.9416, 65: 0.9444, 66: 0.9473, 67: 0.9501, 68: 0.9529, 69: 0.9556, 70: 0.9584 },
            65: { 50: 0.8979, 51: 0.9001, 52: 0.9025, 53: 0.9049, 54: 0.9075, 55: 0.9101, 56: 0.9128, 57: 0.9155, 58: 0.9183, 59: 0.9212, 60: 0.9242, 61: 0.9271, 62: 0.9302, 63: 0.9332, 64: 0.9363, 65: 0.9393, 66: 0.9424, 67: 0.9454, 68: 0.9485, 69: 0.9514, 70: 0.9544 },
            66: { 50: 0.8901, 51: 0.8925, 52: 0.8949, 53: 0.8974, 54: 0.9000, 55: 0.9028, 56: 0.9056, 57: 0.9084, 58: 0.9114, 59: 0.9144, 60: 0.9175, 61: 0.9207, 62: 0.9239, 63: 0.9272, 64: 0.9304, 65: 0.9337, 66: 0.9370, 67: 0.9403, 68: 0.9436, 69: 0.9468, 70: 0.9500 },
            67: { 50: 0.8819, 51: 0.8843, 52: 0.8868, 53: 0.8894, 54: 0.8921, 55: 0.8949, 56: 0.8978, 57: 0.9009, 58: 0.9040, 59: 0.9072, 60: 0.9104, 61: 0.9138, 62: 0.9171, 63: 0.9206, 64: 0.9241, 65: 0.9276, 66: 0.9311, 67: 0.9347, 68: 0.9382, 69: 0.9417, 70: 0.9452 },
            68: { 50: 0.8731, 51: 0.8756, 52: 0.8782, 53: 0.8809, 54: 0.8837, 55: 0.8866, 56: 0.8896, 57: 0.8927, 58: 0.8960, 59: 0.8993, 60: 0.9027, 61: 0.9063, 62: 0.9098, 63: 0.9135, 64: 0.9172, 65: 0.9210, 66: 0.9247, 67: 0.9285, 68: 0.9323, 69: 0.9361, 70: 0.9399 },
            69: { 50: 0.8639, 51: 0.8664, 52: 0.8690, 53: 0.8718, 54: 0.8747, 55: 0.8777, 56: 0.8808, 57: 0.8841, 58: 0.8875, 59: 0.8909, 60: 0.8945, 61: 0.8982, 62: 0.9020, 63: 0.9059, 64: 0.9098, 65: 0.9138, 66: 0.9178, 67: 0.9219, 68: 0.9259, 69: 0.9300, 70: 0.9341 },
            70: { 50: 0.8541, 51: 0.8567, 52: 0.8594, 53: 0.8622, 54: 0.8652, 55: 0.8683, 56: 0.8715, 57: 0.8749, 58: 0.8784, 59: 0.8820, 60: 0.8858, 61: 0.8896, 62: 0.8936, 63: 0.8977, 64: 0.9018, 65: 0.9060, 66: 0.9103, 67: 0.9147, 68: 0.9190, 69: 0.9234, 70: 0.9278 }
        };

        const optionDTable = {
            55: { 50: 0.9765, 51: 0.9773, 52: 0.9781, 53: 0.9789, 54: 0.9797, 55: 0.9805, 56: 0.9814, 57: 0.9822, 58: 0.9830, 59: 0.9838, 60: 0.9846, 61: 0.9854, 62: 0.9862, 63: 0.9870, 64: 0.9877, 65: 0.9885, 66: 0.9893, 67: 0.9900, 68: 0.9908, 69: 0.9915, 70: 0.9923 },
            56: { 50: 0.9748, 51: 0.9757, 52: 0.9765, 53: 0.9774, 54: 0.9782, 55: 0.9791, 56: 0.9800, 57: 0.9808, 58: 0.9817, 59: 0.9826, 60: 0.9835, 61: 0.9843, 62: 0.9852, 63: 0.9860, 64: 0.9869, 65: 0.9877, 66: 0.9885, 67: 0.9894, 68: 0.9902, 69: 0.9910, 70: 0.9918 },
            57: { 50: 0.9730, 51: 0.9738, 52: 0.9747, 53: 0.9757, 54: 0.9766, 55: 0.9775, 56: 0.9784, 57: 0.9794, 58: 0.9803, 59: 0.9813, 60: 0.9822, 61: 0.9831, 62: 0.9840, 63: 0.9850, 64: 0.9859, 65: 0.9868, 66: 0.9877, 67: 0.9886, 68: 0.9895, 69: 0.9903, 70: 0.9912 },
            58: { 50: 0.9709, 51: 0.9718, 52: 0.9728, 53: 0.9738, 54: 0.9747, 55: 0.9757, 56: 0.9767, 57: 0.9777, 58: 0.9788, 59: 0.9798, 60: 0.9808, 61: 0.9818, 62: 0.9828, 63: 0.9838, 64: 0.9848, 65: 0.9857, 66: 0.9867, 67: 0.9877, 68: 0.9886, 69: 0.9896, 70: 0.9905 },
            59: { 50: 0.9687, 51: 0.9697, 52: 0.9707, 53: 0.9717, 54: 0.9727, 55: 0.9738, 56: 0.9748, 57: 0.9759, 58: 0.9770, 59: 0.9781, 60: 0.9792, 61: 0.9803, 62: 0.9813, 63: 0.9824, 64: 0.9835, 65: 0.9846, 66: 0.9856, 67: 0.9867, 68: 0.9877, 69: 0.9887, 70: 0.9897 },
            60: { 50: 0.9662, 51: 0.9672, 52: 0.9683, 53: 0.9694, 54: 0.9705, 55: 0.9716, 56: 0.9727, 57: 0.9739, 58: 0.9750, 59: 0.9762, 60: 0.9774, 61: 0.9785, 62: 0.9797, 63: 0.9809, 64: 0.9820, 65: 0.9832, 66: 0.9843, 67: 0.9855, 68: 0.9866, 69: 0.9877, 70: 0.9888 },
            61: { 50: 0.9635, 51: 0.9646, 52: 0.9657, 53: 0.9668, 54: 0.9680, 55: 0.9692, 56: 0.9704, 57: 0.9716, 58: 0.9729, 59: 0.9741, 60: 0.9754, 61: 0.9766, 62: 0.9779, 63: 0.9791, 64: 0.9804, 65: 0.9816, 66: 0.9829, 67: 0.9841, 68: 0.9853, 69: 0.9865, 70: 0.9877 },
            62: { 50: 0.9606, 51: 0.9617, 52: 0.9628, 53: 0.9640, 54: 0.9653, 55: 0.9665, 56: 0.9678, 57: 0.9691, 58: 0.9704, 59: 0.9717, 60: 0.9731, 61: 0.9744, 62: 0.9758, 63: 0.9772, 64: 0.9785, 65: 0.9799, 66: 0.9812, 67: 0.9825, 68: 0.9839, 69: 0.9852, 70: 0.9864 },
            63: { 50: 0.9573, 51: 0.9585, 52: 0.9597, 53: 0.9610, 54: 0.9623, 55: 0.9636, 56: 0.9650, 57: 0.9663, 58: 0.9677, 59: 0.9691, 60: 0.9706, 61: 0.9720, 62: 0.9735, 63: 0.9749, 64: 0.9764, 65: 0.9779, 66: 0.9793, 67: 0.9808, 68: 0.9822, 69: 0.9836, 70: 0.9850 },
            64: { 50: 0.9539, 51: 0.9551, 52: 0.9564, 53: 0.9577, 54: 0.9590, 55: 0.9604, 56: 0.9618, 57: 0.9633, 58: 0.9648, 59: 0.9663, 60: 0.9678, 61: 0.9694, 62: 0.9709, 63: 0.9725, 64: 0.9741, 65: 0.9757, 66: 0.9772, 67: 0.9788, 68: 0.9804, 69: 0.9819, 70: 0.9834 },
            65: { 50: 0.9501, 51: 0.9514, 52: 0.9527, 53: 0.9541, 54: 0.9555, 55: 0.9570, 56: 0.9585, 57: 0.9600, 58: 0.9616, 59: 0.9632, 60: 0.9649, 61: 0.9665, 62: 0.9682, 63: 0.9699, 64: 0.9716, 65: 0.9733, 66: 0.9750, 67: 0.9767, 68: 0.9784, 69: 0.9800, 70: 0.9817 },
            66: { 50: 0.9462, 51: 0.9475, 52: 0.9489, 53: 0.9503, 54: 0.9518, 55: 0.9533, 56: 0.9549, 57: 0.9566, 58: 0.9582, 59: 0.9599, 60: 0.9617, 61: 0.9634, 62: 0.9652, 63: 0.9670, 64: 0.9689, 65: 0.9707, 66: 0.9725, 67: 0.9744, 68: 0.9762, 69: 0.9780, 70: 0.9798 },
            67: { 50: 0.9420, 51: 0.9433, 52: 0.9448, 53: 0.9463, 54: 0.9478, 55: 0.9494, 56: 0.9511, 57: 0.9528, 58: 0.9546, 59: 0.9564, 60: 0.9582, 61: 0.9601, 62: 0.9620, 63: 0.9639, 64: 0.9659, 65: 0.9679, 66: 0.9699, 67: 0.9719, 68: 0.9739, 69: 0.9758, 70: 0.9778 },
            68: { 50: 0.9375, 51: 0.9389, 52: 0.9404, 53: 0.9420, 54: 0.9436, 55: 0.9453, 56: 0.9470, 57: 0.9488, 58: 0.9506, 59: 0.9526, 60: 0.9545, 61: 0.9565, 62: 0.9585, 63: 0.9606, 64: 0.9627, 65: 0.9648, 66: 0.9670, 67: 0.9691, 68: 0.9713, 69: 0.9734, 70: 0.9756 },
            69: { 50: 0.9327, 51: 0.9342, 52: 0.9358, 53: 0.9374, 54: 0.9391, 55: 0.9408, 56: 0.9426, 57: 0.9445, 58: 0.9465, 59: 0.9485, 60: 0.9505, 61: 0.9527, 62: 0.9548, 63: 0.9570, 64: 0.9593, 65: 0.9616, 66: 0.9639, 67: 0.9662, 68: 0.9685, 69: 0.9709, 70: 0.9732 },
            70: { 50: 0.9277, 51: 0.9292, 52: 0.9308, 53: 0.9325, 54: 0.9343, 55: 0.9361, 56: 0.9380, 57: 0.9400, 58: 0.9420, 59: 0.9441, 60: 0.9463, 61: 0.9485, 62: 0.9508, 63: 0.9532, 64: 0.9556, 65: 0.9580, 66: 0.9605, 67: 0.9630, 68: 0.9655, 69: 0.9681, 70: 0.9706 }
        };

        function getAgeFactor(table, memberAge, spouseAge) {
            memberAge = Math.round(memberAge);
            spouseAge = Math.round(spouseAge);
            if (spouseAge < 50) spouseAge = 50; // Minimum spouse age is 50
            return table[memberAge]?.[spouseAge] || 1; // Default to 1 if not found
        }

        function calculateYears(start, end) {
            const diff = new Date(end) - new Date(start);
            return diff / (1000 * 60 * 60 * 24 * 365.25);
        }

        function adjustToFirstOfMonth(dateStr) {
            const date = new Date(dateStr);
            date.setDate(1);
            return date.toISOString().split('T')[0];
        }

        function formatNumber(num) {
            const value = parseFloat(num);
            if (isNaN(value)) return 'N/A';
            return value >= 1000 ? value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : value.toFixed(2);
        }

        function calculate() {
            const tier = document.getElementById('tier').value;
            const startDate = document.getElementById('startDate').value;
            const birthDate = document.getElementById('birthDate').value;
            const spouseBirthDate = document.getElementById('spouseBirthDate').value;

            const options = [1, 2, 3, 4].map(i => ({
                retireDate: adjustToFirstOfMonth(document.getElementById(`retireDate${i}`).value),
                salary: parseFloat(document.getElementById(`salary${i}`).value) || 0
            }));

            const memberAgeAtRetirement = options.map(opt => 
                calculateYears(birthDate, opt.retireDate));
            const spouseAgeAtRetirement = spouseBirthDate ? 
                options.map(opt => calculateYears(spouseBirthDate, opt.retireDate)) : [];

            const tierDivisors = { '1': 55, '2': 55, '3': 60, '4': 60, '5': 65 };
            const divisor = tierDivisors[tier];

            const summaryData = [];

            options.forEach((opt, i) => {
                if (!opt.retireDate || !opt.salary && i !== 0) {
                    console.log(`Skipping Option ${i + 1}: No date or salary`);
                    return;
                }
                if (i === 0 && (!opt.retireDate || !opt.salary)) {
                    alert("Option 1 is required.");
                    console.log('Option 1 required but missing data');
                    return;
                }

                // Calculate service years for each option individually
                const serviceYears = calculateYears(startDate, opt.retireDate);
                const maxOption = (serviceYears / divisor) * opt.salary;

                const ageFactorA = spouseBirthDate ? 
                    getAgeFactor(optionATable, memberAgeAtRetirement[i], spouseAgeAtRetirement[i]) : 1;
                const ageFactorB = spouseBirthDate ? 
                    getAgeFactor(optionBTable, memberAgeAtRetirement[i], spouseAgeAtRetirement[i]) : 1;
                const ageFactorC = spouseBirthDate ? 
                    getAgeFactor(optionCTable, memberAgeAtRetirement[i], spouseAgeAtRetirement[i]) : 1;
                const ageFactorD = spouseBirthDate ? 
                    getAgeFactor(optionDTable, memberAgeAtRetirement[i], spouseAgeAtRetirement[i]) : 1;

                const optionA = maxOption * ageFactorA;
                const optionB = maxOption * ageFactorB;
                const optionC = maxOption * ageFactorC;
                const optionD = maxOption * ageFactorD;

                const results = `
                    Service Years: ${serviceYears.toFixed(2)}<br>
                    Tier Divisor: ${divisor}<br>
                    Average Salary: $${formatNumber(opt.salary)}<br>
                    Max Option Calculation: (${serviceYears.toFixed(2)} / ${divisor}) × $${formatNumber(opt.salary)} = $${formatNumber(maxOption)} (Annual)<br>
                    ${spouseBirthDate ? `Member Age: ${memberAgeAtRetirement[i].toFixed(2)}, Spouse Age: ${Math.max(spouseAgeAtRetirement[i], 50).toFixed(2)}<br>` : ''}
                    ${spouseBirthDate ? `Option A Factor: ${ageFactorA.toFixed(4)}, ` : ''}Option A: $${formatNumber(optionA)} (Annual)<br>
                    ${spouseBirthDate ? `Option B Factor: ${ageFactorB.toFixed(4)}, ` : ''}Option B: $${formatNumber(optionB)} (Annual)<br>
                    ${spouseBirthDate ? `Option C Factor: ${ageFactorC.toFixed(4)}, ` : ''}Option C: $${formatNumber(optionC)} (Annual)<br>
                    ${spouseBirthDate ? `Option D Factor: ${ageFactorD.toFixed(4)}, ` : ''}Option D: $${formatNumber(optionD)} (Annual)
                `;
                document.getElementById(`result${i + 1}`).innerHTML = results;

                summaryData.push({
                    retireDate: opt.retireDate,
                    maxOption: (maxOption / 12).toFixed(2),
                    optionA: (optionA / 12).toFixed(2),
                    optionB: (optionB / 12).toFixed(2),
                    optionC: (optionC / 12).toFixed(2),
                    optionD: (optionD / 12).toFixed(2)
                });
            });

            const summaryElement = document.getElementById('summary');
            if (summaryData.length > 0) {
                const summaryTable = `
                    <h3>Summary of Retirement Options (Monthly)</h3>
                    <table class="summary-table">
                        <tr>
                            <th>Retirement Date</th>
                            <th>Maximum Option</th>
                            <th>Option A</th>
                            <th>Option B</th>
                            <th>Option C</th>
                            <th>Option D</th>
                        </tr>
                        ${summaryData.map(data => `
                            <tr>
                                <td>${data.retireDate || 'N/A'}</td>
                                <td>$${formatNumber(data.maxOption)}</td>
                                <td>$${formatNumber(data.optionA)}</td>
                                <td>$${formatNumber(data.optionB)}</td>
                                <td>$${formatNumber(data.optionC)}</td>
                                <td>$${formatNumber(data.optionD)}</td>
                            </tr>
                        `).join('')}
                    </table>
                `;
                summaryElement.innerHTML = summaryTable;
            } else {
                summaryElement.innerHTML = '<p>No valid options to summarize.</p>';
            }
        }
    </script>
</body>
</html>
